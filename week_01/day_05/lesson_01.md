# Le phishing

## 1. Introduction

![courtneycox](https://raw.githubusercontent.com/bafraikin/ressource_thp_cursus_secu/master/ressources/jour_05/Quotefancy-887164-3840x2160.jpg)


## 2. Historique et contexte
Le phishing c’est un peu la version flemmarde du hacking. C’est celle où au lieu de se dire “je vais trouver cette information moi-même" on prend plutôt le chemin de “je vais juste demander et les gens vont répondre parce qu'ils sont gentils”
Ici vos capacités d’empathie et d'ingénierie sociale vont vous servir.
Le phishing c’est pas forcément par mail, ça peut être dans une enveloppe physique, c’est d’ailleurs encore plus redoutable ou par téléphone ( vishing voice-phishing )
Quand le phishing n’est pas un phishing de masse et qu’il cible une personne très particulière c’est du Spear-phishing

Et honnêtement c’est la façon la plus efficace, vraiment, juste demandez l’info et vous serez surpris à quel point les gens aiment répondre aux questions.
Parfois vous ne savez pas la valeur des informations que vous possédez. Cela peut amener à donner l’information sans se méfier à la personne qui le demande.

Saviez vous qu' avec ces deux questions
“c’est quoi ta date d’anniversaire ? ” “c’est quoi ta ville de naissance ?”
On peut déduire les 8 premiers chiffres de votre numéro de sécurité sociale.

Les 5 derniers. Il faut  juste les demander. Les gens se méfieront moins de donner juste les derniers chiffres d’un numéro de carte vitale.
Par exemple: un mail envoyé qui dit qu’une activité suspecte avec son numéro de sécurité sociale a été signalé et que la personne doit envoyer les 5 derniers numéros de sa carte de sécu pour confirmer qu’il en est bien le propriétaire et confirmer que les activités doivent être annulés.

[Que faire avec un numero de carte vitale ?](https://www.numerama.com/cyberguerre/695983-que-peuvent-faire-les-malfaiteurs-avec-votre-numero-de-securite-sociale.html)


Voici typiquement le genre d’info que quelqu’un peut vous pouvez donner sans trop savoir ce qu’il est en train de faire. Vous pouvez très bien demander tout un tas d’autres choses.
Dans le cas pratique d’une entreprise, le numéro d’identification d’un employé dans une boîte, son numéro de bureau, son bâtiment etc.. Toutes ces informations peuvent vous permettre
de vous faire passer pour la personne ( bonjour je suis l’employé numero immatriculé #7DB72RUF8KU et j’ai besoin d’un accès à la base de données ) après avoir obtenu ces informations
et pouvoir agir en son nom. Il faut juste qu’il ait confiance en vous, ou qu’il s’y sente obligé ou que cela lui semble la bonne chose à faire.



## 3. Comment faire un bon phishing ?
Dans ce genre de communication tout compte, la présentation visuelle, le niveau de langage utilisé, etc. Tout doit sembler véridique. 
Il est donc aussi important de travailler votre adresse mail. Le mieux est d'utiliser une adresse mail compromise d'un de ses proches/collègues.

Le plus important reste de savoir désactiver l’esprit critique du lecteur. Il existe plusieurs façons de faire ceci.
Comme par exemple une demande venant d’un supérieur, si votre supérieur, ou votre RH vous demande une photocopie de votre carte d’identité pour prendre un ticket de train pour le prochain déplacement, le ferrez-vous avant de vérifier que le mail est bien arrivé par le bon canal, ou même vous demander s’il y a bien un déplacement de prévu ?


Les quelques conseils qu’il y a à prendre en compte :
- Renseignez vous sur la cible comprenez ce qui a de la valeur pour elle. Par exemple, un enseignant/chercheur va plutôt chercher à être publié. Va chercher une renommé pour son travail.
- Renseignez vous sur votre pretexte, le domaine sur lequel il repose, si vos messages ne semblent pas venir du milieu ou sonne faux vous êtes mort
- Vous pouvez être absolument qui vous voulez du moment que vous savez le faire croire, soyez crédibles mais surtout soyez inventifs
- Utilisez le plus possible l’actualité, vous avez plus de chance de paraître crédibles. Actualité mondiale ou actualité personnelle de la cible
- N’oubliez pas qu’il faut quand même retenir l’attention. Pas être exubérant mais retenir l’attention. Sortir du lot sans sortir du cadre.
- Testez avant, ne vous retrouvez pas dans les spams et regardez comment le mail s’affiche
- Less is more, restez simples
- Restez flexibles, si vous êtes inflexibles et peu arrangeants on n'aura pas envie de vous aider.
- Demandez ce que vous voulez obtenir. Tout simplement. ( “on aura juste besoin de votre mot de passe pour finir “ ) Il faut que vous ayez l’air d'être légitimes à recevoir cette information, que cela vous soit due.

Il existe encore aujourd’hui  tout un tas de service legitimes qui fonctionnent avec ce genre de principe. N'ayez pas peur de demander de front ce que vous voulez vraiment, il faut juste bien l'enrober.

- Provoquez une émotion

Vous pouvez vous reposer sur plusieurs émotions ou patterns qui vont vous aider à endormir ou assommer l’esprit critique du lecteur

### La chance/rareté

"Profil choisi à la main, accès limité, nombre limité". Si vous donnez une impression véritable que le lecteur a de la chance, c’est bon pour vous. 
Méfiez-vous, la chance a été vraiment beaucoup utilisée et il y a souvent un réflexe de protection qui suit maintenant ( il y a sûrement eu trop de princes nigérians millionnaires qui vous lèguent de l’argent dans votre boite mail ) qui ressemble un peu à ça “attends attends pourquoi moi ? Attends attends c’est un truc sérieux ?” 
Mais ça marche encore bien quand c’est bien dosé

[amazon_chanceux](https://github.com/bafraikin/ressource_thp_cursus_secu/blob/master/ressources/jour_05/amazon_client.png)

[loyer_pole_emploi](https://github.com/bafraikin/ressource_thp_cursus_secu/blob/master/ressources/jour_05/phishing_loyer.png)
avec pour une fois un effet visible dans la presse de la fin de ce processus. [allez lire l'article](https://www.lockimmo.com/blog-immobilier/histoire-jour-larnaque-a-1-370-euros-pole-emploi)
 

### Flatterie
Quand on est flatté on est plus à même de faire quelque chose sans trop y réfléchir si ça semble anodin 
Pensez à la fable du corbeau et du renard de Jean de la fontaine

### Se sentir redevable
Si dans un scénario vous arrivez à faire que la personne se sente redevable, c’est bon pour vous. Par exemple lui inventer un problème que vous déclarez comme réglé grâce à vous et il manque un renseignement/une action pour finaliser l'opération (ex-problème edf, gaz, inscription à la fac etc … )

### Autorité
Si quelqu’un qui a autorité sur vous vous demande quelque chose, vous y réfléchirez moins ( ex: votre boss, service RH... Mais aussi les services de l’état, la préfecture, [la police](https://twitter.com/MaximeHaes/status/1436246216157896704?s=20) etc .. )


### La peur
Quand on a peur, on reflechit de manière très très prévisible.
[mail_paypal](https://github.com/bafraikin/ressource_thp_cursus_secu/blob/master/ressources/jour_05/paypal.png)


### Concession
Quand quelqu’un a l’impression qu’on lui fait une fleur, il va chercher à en profiter et à se dépêcher sans trop réfléchir. ( Technique très utilisée en marketing ou vente, marche un peu moins bien si trop évidente)

### Réciprocité
Il existe une logique d’entraide entre les gens qui sont vos semblables. Parfois si on sent qu’on vient du même endroit, qu’on est dans la même galère on a envie de se serrer les coudes. Si c’est demandé assez gentiment on peut avoir envie d’aider, ça flatte l’ego d’aider quelqu’un sans rien en retour et ça c’est pas mal.

### Appréciation
Les gens aiment aider les gens qui les apprécient et ceux qui les aiment pour ce qu’ils sont vraiment. 
L’attraction physique peut même être un plus. Même si on ne vit plus au siècle dernier, ce compliment peut encore très bien marcher.

### Conformation Social
Vous avez envie de faire ce que les autres font. Si on vous convainc que les autres font quelque chose dans une situation donnée, vous aurez plus envie de faire la même chose.
Il existe beaucoup d'expériences qui montrent à quel point on n’aime pas sortir du lot.

### Altérer la réalité ( framing )

Dire qu’un produit et 75% non gras reviennent au même que dire qu’il contient 25% de graisse, mais l’un est plus sympa et réussit à dissimuler la réalité si la cible n’y réfléchit pas. 
Suivant ce principe, dire l’inverse de quelque chose de négatif permet parfois d’éviter d'éveiller l’esprit critique.
On voit ceci dans les discours politiques, souvent sur des statistiques ou par exemple par des choix de mot comme “venir stimuler l'économie" plutôt qu’un “renflouement économique"

## 4. A retenir

La chose la plus importante à retenir est que l'émotion éteint l'esprit critique de celui qui la subit. Si vous arrivez à en provoquer et anticiper la réaction de la personne en accord avec cette émotion alors vous saurez comment la manipuler.
Si vous voulez vous protéger contre ce genre d'attaque, il faut rester extrêmement vigilants et faire attention à vos propres actions sous le coup d'une émotion. Vous devriez bien réfléchir avant de faire une action et vous posez au moins une question "Est-ce que je connais tous les tenants et aboutissants de l'action que je compte faire ?". Vous pouvez aussi vous demander "Qui a intérêt à l'action que je vais effectuer ?"

Et surtout si vous le pouvez, vérifier par un autre canal que l'action demandée ou suggérée entre les lignes est légitime ; ne cliquez pas sur un lien dans un mail qui vous produit une émotion.

## 5. Pour aller plus loins
### Mon exemple favoris

À titre personnel mon exemple préféré vient du livre “Advanced Penetration Testing” de Wil Allsop.

Il y raconte comment après avoir créé un virus contenu dans les macros d’une feuille Excel, il convainc un employé d’une entreprise d’ouvrir la feuille et d’activer les macros. 

Le contexte est ici aussi important que le contenu du mail.

- Le mail a l’air de venir du RH de la boîte. 
- Le mail a l’air d'être arrivé dans la boîte mail de l’employé par hasard parce que le mail s’adresse à son manager et dit que c’est un sujet confidentiel et que les employés que le manager gère n’ont pas besoin de connaître le contenu de ce mail. 
- Le mail a le ton de la confidence.
- Le corps du mail ressemble un peu à ceci

```
Salut Eric,
Comme convenu je te joins la liste des employés dont on va devoir se séparer avec la fusion à venir.
Comme la fusion avec l'entreprise X est encore secrète, garde cela pour toi,

Cordialement,

Jean Mich du Service RH

PS: passe le salut à ta femme Gertrude

```

Évidemment un employé va vouloir cliquer et évidemment qu’il activera les macros dans la précipitation. Il le fera d’autant plus si toutes les informations sur le nom du manager et le prénom de sa femme sont correctes.
Ici ce mail active les sentiments de la chance et de la peur, l’employé s’estime chanceux d’avoir cette information en avance et a peur d'être contenu dans la pièce jointe fournie et de perdre son job bientôt. 
Ce que j’aime particulièrement avec ce mail c’est qu'il ne va rien dire à personne à propos de sa réception par lui-même et pas par le manager. De peur que les informations qu’il a apprises dans ce mail lui portent préjudice.


## Pour creuser encore le sujet de votre coté
Il y a des livres pour creuser encore plus le sujet
J’ai particulièrement aimé **the art of deception** de Kevin Mitnick qui fournit moult exemple et explication
Ou **Social Engineering the art of human hacking** qui fournit moins d’exemples, mais plus de methodo
Si vous voulez creuser encore plus il y a une liste de livre sur le site social engineer.org

Je vous conseille [ce petit tuto ](https://mrd0x.com/abusing-google-drives-email-file-functionality/)pour filouter encore plus 


